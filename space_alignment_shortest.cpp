#include<bits/stdc++.h> 
#define br break
using namespace std;typedef struct{int k,t,s,r,q;} node;int main(){int i,j,l,n,q,r,w,z,m,k=0,h=0,e=0;cin >> n;vector<int>va(n,0),vb(n,0);vector<bool>c(n,false);for (i=0;i<n;i++){string s;cin >> s;for (j=0;j<s.length();j++){if (s[j]=='t')va[i]++;else if (s[j]=='s')vb[i]++;else if (s[j]=='{')c[i]=true;}}vector<int>d(n,0);stack<node>s;s.push({0,0,0,0,0});for (i=1;i<n;i++){if (k > 0){for (j=0;j<n;j++){if (va[j]!=0||vb[j]!=0){e=k*va[j]+vb[j];br;}}for (l=0;l<n;l++){d[l]=l*e;}br;}if (c[i]==false){if (s.size()==1){if (va[i]!=0||vb[i]!=0){k=-1;br;}s.pop();continue;}node &last=s.top();q=vb[i]-last.s;r=va[i]-last.t;if ((r==0&&q!=0)||(q==0&&r!=0)){k=-1;br;}if (r==0&&q==0){s.pop();continue;}if (q%r!=0){k=-1;br;}if ((double)q /(-r)<0){k=-1;br;}m=q/(-r);if (k==0){k=m;}else if (k!=m){k=-1;br;}s.pop();}else{if (s.size()==0){if (va[i]!=0||vb[i]!=0){k=-1;br;}s.push({k,0,0,0,0});continue;}else if (s.size()==1){s.push({k,va[i],vb[i],va[i],vb[i]});continue;}node &last=s.top();q=vb[i]-last.s,r=va[i]-last.t;if ((r==last.r&&q!=last.q)||(q==last.q&&r!=last.r)){k=-1;br;}if (r==q){s.push(last);continue;}w=q-last.q,z=last.r-r;if (z==0&&w!=0){k=-1;br;}else if (z==0&&w==0){s.push({k,va[i],vb[i],r,q});continue;}if (w%z!=0){k=-1;br;}if ((double)w/z<0){k=-1;br;}m=w/z;if (k==0){k=m;}else if (k!=m){k=-1;br;}s.push({k,va[i],vb[i],r,q});}}if (k==-1){cout << "-1";return 0;}else if (k==0){cout << "1";return 0;}for (i=0;i<n;i++){if (c[i]){if (k*va[i]+vb[i]!=d[h]){cout << "-1";return 0;}h++;}else{if (k*va[i]+vb[i]!=d[h-1]){cout << "-1";return 0;}h--;}}cout << k << "";return 0;}
